{% extends 'base.html' %}
{% load static %}

{% block content %}

<style>
     /* card */
         .bikes-showcase {
            padding: 60px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        
        .section-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 50px;
        }
        
        .bike-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .bike-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        
        .bike-image-container {
            position: relative;
            height: 280px;
            /* background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); */
            background: url('/static/images/background.png') center/cover no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .bike-image {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 10px;
        }
        
        .brand-logo {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.9);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            color: #2c3e50;
        }
        
        .bike-details {
            padding: 25px;
            background: linear-gradient(135deg, #e8f5f1 0%, #d5f0e7 100%);
        }
        
        .bike-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .bike-specs {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #5a6c7d;
        }
        
        .bike-specs i {
            margin-right: 5px;
            color: #27ae60;
        }
        
        .bike-price {
            font-size: 1.4rem;
            font-weight: bold;
            color: #27ae60;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .bike-location {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .bike-location i {
            margin-right: 8px;
            color: #e74c3c;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f39c12;
            opacity: 0.8;
        }
        
        .confetti:nth-child(1) { top: 20%; left: 10%; animation: float 3s ease-in-out infinite; }
        .confetti:nth-child(2) { top: 60%; left: 20%; animation: float 2s ease-in-out infinite 0.5s; }
        .confetti:nth-child(3) { top: 40%; left: 80%; animation: float 2.5s ease-in-out infinite 1s; }
        .confetti:nth-child(4) { top: 80%; left: 70%; animation: float 3.5s ease-in-out infinite 1.5s; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        .view-all-btn {
            text-align: center;
            margin-top: 40px;
        }
        
        .btn-custom {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
        }
        
        .btn-custom:hover {
            background: linear-gradient(135deg, #2980b9, #1f5f8b);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

</style>
<div class="container-fluid my-4">
  <div class="row">

    <!-- Filter Sidebar -->
    <aside class="col-md-3">
      <div class="p-3 bg-light rounded shadow-sm">
        <h5 class="fw-bold mb-3">Filter</h5>
        <form method="get">

          <!-- Brand -->
          <h6>Brand</h6>
          <select name="brand" class="form-select mb-3">
            <option value="">All</option>
            {% for b in brands %}
              <option value="{{ b }}" {% if request.GET.brand == b %}selected{% endif %}>{{ b }}</option>
            {% endfor %}
          </select>

          <!-- Year -->
          <h6>Year</h6>
          <select name="year" class="form-select mb-3">
            <option value="">All</option>
            {% for y in years %}
              <option value="{{ y }}" {% if request.GET.year == y|stringformat:"s" %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
          </select>

          <!-- CC -->
          <h6>Engine Trim CC</h6>
          <input type="text" name="cc" class="form-control mb-3" placeholder="e.g. 150" value="{{ request.GET.cc }}">

          <!-- Budget -->
          <h6>Budget (â‚¹)</h6>
          <div class="row mb-3">
            <div class="col-6">
              <input type="number" name="min_price" class="form-control" placeholder="Min" value="{{ request.GET.min_price }}">
            </div>
            <div class="col-6">
              <input type="number" name="max_price" class="form-control" placeholder="Max" value="{{ request.GET.max_price }}">
            </div>
          </div>

          <!-- Kilometers -->
          <h6>Kilometers</h6>
          <div class="row mb-3">
            <div class="col-6">
              <input type="number" name="min_km" class="form-control" placeholder="Min" value="{{ request.GET.min_km }}">
            </div>
            <div class="col-6">
              <input type="number" name="max_km" class="form-control" placeholder="Max" value="{{ request.GET.max_km }}">
            </div>
          </div>

          <!-- Fuel -->
          <h6>Fuel Type</h6>
          <select name="fuel_type" class="form-select mb-3">
            <option value="">All</option>
            <option value="petrol" {% if request.GET.fuel_type == "petrol" %}selected{% endif %}>Petrol</option>
            <option value="diesel" {% if request.GET.fuel_type == "diesel" %}selected{% endif %}>Diesel</option>
            <option value="electric" {% if request.GET.fuel_type == "electric" %}selected{% endif %}>Electric</option>
          </select>

          <!-- Owner -->
          <h6>Owner</h6>
          <select name="owner_number" class="form-select mb-3">
            <option value="">All</option>
            <option value="1st" {% if request.GET.owner_number == "1st" %}selected{% endif %}>1st Owner</option>
            <option value="2nd" {% if request.GET.owner_number == "2nd" %}selected{% endif %}>2nd Owner</option>
            <option value="3rd" {% if request.GET.owner_number == "3rd" %}selected{% endif %}>3rd Owner</option>
          </select>

          <button type="submit" class="btn btn-primary w-100">Apply Filters</button>
        </form>
      </div>
    </aside>

    <!-- Bike Listings -->
    <section class="col-md-9">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-bold">{{ bikes.count }} Bikes In Tamil Nadu</h5>
        <form method="get" class="d-flex align-items-center">
          <label  class="me-2 text-center">Sort By</label>
          <select name="sort" class="form-select" onchange="this.form.submit()">
            <option value="newest" {% if request.GET.sort == "newest" %}selected{% endif %}>Newest First</option>
            <option value="price_low" {% if request.GET.sort == "price_low" %}selected{% endif %}>Price: Low to High</option>
            <option value="price_high" {% if request.GET.sort == "price_high" %}selected{% endif %}>Price: High to Low</option>
          </select>
        </form>
      </div>

      <div class="row g-4">
        {% for bike in bikes %}
        <div class="col-lg-4 col-md-6">
          <div class="card shadow-sm border-0 h-100">
            <img src="{{ bike.image.url }}" class="card-img-top" alt="{{ bike.name }}">
            <div class="card-body bg-light">
              <h6 class="fw-bold">{{ bike.year }} | {{ bike.brand }} {{ bike.name }} | {{ bike.cc }}</h6>
              <p class="mb-1">
                <i class="fas fa-tachometer-alt"></i> {{ bike.formatted_km }} &nbsp;
                <i class="fas fa-gas-pump"></i> {{ bike.get_fuel_type_display }} &nbsp;
                <i class="fas fa-user"></i> {{ bike.get_owner_number_display }}
              </p>
              <p class="fw-bold text-success">{{ bike.formatted_price }}</p>
              <p class="mb-0"><i class="fas fa-map-marker-alt"></i> {{ bike.location }}</p>
            </div>
          </div>
        </div>
        {% empty %}
        <p>No bikes found.</p>
        {% endfor %}
      </div>
    </section>
  </div>
</div>
{% endblock %}